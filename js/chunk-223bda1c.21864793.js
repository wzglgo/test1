(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-223bda1c"],{2607:function(t,e,a){"use strict";a("c332a")},"5e95":function(t,e,a){"use strict";a("e01a")},"8e8c":function(t,e,a){"use strict";a.d(e,"e",(function(){return i})),a.d(e,"b",(function(){return r})),a.d(e,"g",(function(){return o})),a.d(e,"a",(function(){return s})),a.d(e,"f",(function(){return c})),a.d(e,"d",(function(){return l})),a.d(e,"c",(function(){return d}));var n=a("b775"),i=function(t){return Object(n["a"])("GET","/dapp/information/getInformationAdminIndex",t,!0,!0,1)},r=function(t){return Object(n["a"])("GET","/dapp/information/adminList",t)},o=function(t){return Object(n["a"])("GET","/dapp/information/list",t,!0,!0)},s=function(t){return Object(n["a"])("POST","/dapp/information",t)},c=function(t){return Object(n["a"])("GET","/dapp/information/".concat(t),t,!0,!0)},l=function(t){return Object(n["a"])("PUT","/dapp/information",t)},d=function(t){return Object(n["a"])("DELETE","/dapp/information/".concat(t))}},a261:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var n=a("b775"),i=function(t){return Object(n["a"])("POST","/dapp/oss/upload",t,!0,!0)}},c332a:function(t,e,a){},e01a:function(t,e,a){},f073:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"release-wrap"},[a("CommonHeader",{attrs:{title:t.$t("admin.releaseArticle")}}),a("div",{staticClass:"page-wrap"},[a("div",{staticClass:"notice"},[t._v(t._s(t.$t("common.newsTitle")))]),a("div",{staticClass:"title-wrap"},[a("VanField",{staticClass:"title-field",attrs:{rows:"3",autosize:"",type:"textarea",translate:"no",maxlength:"50",placeholder:t.$t("common.inputTitle"),"show-word-limit":""},model:{value:t.dataForm.title,callback:function(e){t.$set(t.dataForm,"title",e)},expression:"dataForm.title"}})],1),a("div",{staticClass:"notice"},[t._v(t._s(t.$t("admin.setPreview")))]),a("div",{staticClass:"set-image"},[a("van-uploader",{attrs:{"after-read":t.afterRead,accept:"image/png,image/jpg","max-size":10485760},on:{oversize:t.onOversize,delete:t.deleteFile},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}},[a("div",{staticClass:"upload-banner"},[a("svg",{staticClass:"upload-icon"},[a("use",{attrs:{href:"#picture"}})]),a("div",{staticClass:"upload-title"},[t._v(t._s(t.$t("common.selectImage")))]),a("div",{staticClass:"upload-content"},[a("div",[t._v("Recommended size: JPG, PNG")]),a("div",[t._v("(345x150px, Max 10mb)")])])])])],1),a("div",{staticClass:"notice"},[t._v(t._s(t.$t("common.newsContent")))]),a("div",{staticClass:"editor",attrs:{translate:"no"}},[a("Editor",{attrs:{height:"440"},model:{value:t.dataForm.content,callback:function(e){t.$set(t.dataForm,"content",e)},expression:"dataForm.content"}})],1),a("div",{staticClass:"switch-wrap"},[a("div",{staticClass:"filed"},[a("div",[t._v(t._s(t.$t("admin.important")))]),a("van-switch",{staticClass:"form-switch",attrs:{size:"30","inactive-color":"#888888","active-value":1,"inactive-value":0},on:{change:t.handleIsImportant},model:{value:t.dataForm.isImportant,callback:function(e){t.$set(t.dataForm,"isImportant",e)},expression:"dataForm.isImportant"}})],1),a("div",{staticClass:"note"},[t._v(t._s(t.$t("common.newsimportantTip")))])]),a("div",{staticClass:"submit-button",on:{click:t.handleAddNews}},[t._v(t._s(t.$t("admin.release")))])])],1)},i=[],r=a("a43d"),o=a("d941"),s=a("c3ae"),c=(a("0e27"),a("f645")),l=a("8e8c"),d=a("a261"),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("quill-editor",{ref:"myTextEditor",staticClass:"editorBox",style:{height:t.height+"px",marginBottom:t.marginB+"px"},attrs:{options:t.editorOption,disabled:t.disabled},on:{change:function(e){return t.onEditorChange(e)}},model:{value:t.data,callback:function(e){t.data=e},expression:"data"}}),a("div",{staticStyle:{"text-align":"right","font-size":"12px"}},[t._v(" "+t._s(t.TiLength)+"/"+t._s(t.limit)+" ")])],1)},m=[],p=(a("d354"),a("13b6"),a("f4d8"),a("cd3e"),a("67ad"),a("b881")),f=(a("121a"),a("7e41"),a("96be"),a("31c4"),a("89e3")),h={action:c["a"].server+"/dapp/oss/upload",methods:"POST",name:"file",size:2e3,accept:"image/png, image/gif, image/jpeg, image/bmp, image/x-icon"},v=[["bold","italic","underline","strike"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{color:[]},{background:[]}],[{align:[]}],["clean"],["link","image"]],g={image:function(){var t=this,e=this.container.querySelector("input.ql-image[type=file]");null===e&&(e=document.createElement("input"),e.setAttribute("type","file"),h.name&&e.setAttribute("name",h.name),e.setAttribute("accept",h.accept),e.classList.add("ql-image"),e.addEventListener("change",(function(){var a=new FormData;a.append(h.name,e.files[0]);var n=new XMLHttpRequest;n.open(h.methods,h.action,!0),n.onload=function(a){if(200===n.status){a=JSON.parse(n.responseText);var i=t.quill.getSelection(!0).index;t.quill.insertEmbed(i,"image",c["a"].imgUrl+a.data.url),t.quill.setSelection(i+1)}e.value=""},n.upload.onloadstart=function(t){e.value=""},n.upload.onerror=function(t){f["a"].error({message:"图片上传失败"})},n.upload.onloadend=function(t){},n.send(a)})),this.container.appendChild(e)),e.click()}},b={placeholder:"",modules:{toolbar:{container:v,handlers:g}}},x={components:{},props:{value:String,height:{type:[Number,String],default:240},marginB:{type:[Number,String],default:10},disabled:{type:Boolean,default:!1},limit:{type:Number,default:4e3}},model:{prop:"value",event:"change"},data:function(){return{data:"",editorOption:b,TiLength:0}},computed:{},created:function(){},watch:{value:{handler:function(t){t&&(this.data=t)},deep:!0,immediate:!0},data:function(t){this.$emit("change",t)},disabled:{handler:function(t){t&&this.$nextTick((function(){var t=document.getElementsByClassName("editorBox")[0],e=document.getElementsByClassName("ql-toolbar")[0];t.removeChild(e)}))},deep:!0,immediate:!0}},methods:{init:function(){var t=this,e=this.$refs.myTextEditor.quill;e.root.addEventListener("paste",(function(e){e.clipboardData&&e.clipboardData.files&&e.clipboardData.files.length&&(e.preventDefault(),[].forEach.call(e.clipboardData.files,(function(e){e.type.match(/^image\/(gif|jpe?g|a?png|bmp)/i)&&t.uploadToServer(e)})))}),!1)},uploadToServer:function(t){var e={action:c["a"].server+"/dapp/oss/upload",methods:"POST",name:"file"},a=new XMLHttpRequest,n=new FormData;n.append(e.name,t),a.open(e.methods,e.action,!0),a.setRequestHeader("Authorization",e.token),a.send(n);var i=this.$refs.myTextEditor.quill;a.onload=function(t){if(200===a.status){t=JSON.parse(a.responseText);var e=i.getSelection(!0).index;i.insertEmbed(e,"image",c["a"].imgUrl+t.data.url),i.setSelection(e+1)}},a.upload.onerror=function(t){this.$message.error("图片上传失败")}},onEditorChange:function(t){t.quill.deleteText(this.limit,1),0===this.value?this.TiLength=0:this.TiLength=t.quill.getLength()-1}},mounted:function(){this.init(),this.TiLength=this.$refs.myTextEditor.quill.getLength()-1;var t=p["Quill"].import("attributors/style/size");t.whitelist=["13px","16px","18px","20px","30px","40px","50px","60px"],p["Quill"].register(t,!0);var e=p["Quill"].import("attributors/style/font"),a=[!1,"Microsoft-YaHei","SimSun","SimHei","KaiTi","FangSong"];e.whitelist=a,p["Quill"].register(e,!0)}},w=x,O=(a("5e95"),a("cba8")),T=Object(O["a"])(w,u,m,!1,null,"5710daaf",null),F=T.exports,j=[["image"]],C={name:"",data:function(){return{newsId:null,title:"",fileList:[],dataForm:{title:"",content:null,type:1,preview:"",isImportant:0},editorOption:{modules:{toolbar:j},theme:"snow",placeholder:""}}},methods:{onOversize:function(t){console.log(t),this.$toast(this.$t("common.10m"))},deleteFile:function(){this.fileList=[],this.dataForm.preview=""},handleIsImportant:function(){console.log(this.dataForm.isImportant)},onEditorChange:function(t){t.editor,t.html,t.text;console.log(123)},afterRead:function(t){var e=this;return Object(s["a"])(Object(o["a"])().mark((function a(){var n,i;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=new FormData,n.append("file",t.file),a.next=4,Object(d["a"])(n);case 4:if(i=a.sent,i.success){a.next=8;break}return e.fileList=[],a.abrupt("return");case 8:e.dataForm.preview=c["a"].imgUrl+i.data.url,console.log(e.fileList);case 10:case"end":return a.stop()}}),a)})))()},handleAddNews:function(){var t=this;return Object(s["a"])(Object(o["a"])().mark((function e(){var a;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.dataForm.content&&t.dataForm.title&&t.dataForm.preview){e.next=2;break}return e.abrupt("return",t.$toast(t.$t("common.fill")));case 2:if(!t.newsId){e.next=8;break}return e.next=5,Object(l["d"])(t.dataForm);case 5:a=e.sent,e.next=11;break;case 8:return e.next=10,Object(l["a"])(t.dataForm);case 10:a=e.sent;case 11:if(a.success){e.next=13;break}return e.abrupt("return");case 13:t.$gbUtils.handleToPage("/mediaAdmin");case 14:case"end":return e.stop()}}),e)})))()},getDetail:function(t){var e=this;return Object(s["a"])(Object(o["a"])().mark((function a(){var n;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(l["f"])(t);case 2:if(n=a.sent,n.success){a.next=5;break}return a.abrupt("return");case 5:e.dataForm=Object(r["a"])({},n.data),console.log("this.dataForm",e.dataForm),e.fileList.push({url:e.dataForm.preview});case 8:case"end":return a.stop()}}),a)})))()}},mounted:function(){console.warn(this.$route.params),Object.keys(this.$route.params).length>0&&(this.newsId=this.$route.params.id,this.getDetail(this.newsId))},components:{Editor:F}},$=C,E=(a("2607"),Object(O["a"])($,n,i,!1,null,"737593ef",null));e["default"]=E.exports}}]);